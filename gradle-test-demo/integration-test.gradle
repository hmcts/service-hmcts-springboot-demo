tasks.register('integrationTest', Test) {
  description = "Runs integration / service bus tests without docker-compose stack"
  group = "Verification"

  testClassesDirs = sourceSets.test.output.classesDirs
  classpath = sourceSets.test.runtimeClasspath
  useJUnitPlatform()
  filter {
    includeTestsMatching '*Integration*'
  }
}

// We do not run this as part of build or test
// But we may need to select this when running tests in intellij when we already have
// docker-compose running
//tasks.named('test') {
//  dependsOn tasks.named('integrationTest')
//}

sourceSets {
  integrationTest {
    java {
      compileClasspath += sourceSets.main.output
      runtimeClasspath += sourceSets.main.output
    }
  }
}

configurations {
  integrationTestImplementation.extendsFrom testImplementation
  integrationTestRuntimeOnly.extendsFrom testRuntimeOnly
}